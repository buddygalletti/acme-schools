<html>
  <head>
    <style>
      a {
        margin-right: 20px;
      }
      #navbar {
        background-color: dodgerblue;
        color: white;
        padding: 1.5em;
        font-size: 20px;
      }
      #navbar > a {
        color: white;
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script
      src="https://unpkg.com/react@16/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
      crossorigin
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-router-dom/5.0.0/react-router-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.1/redux.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-redux/7.1.0/react-redux.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux-thunk/2.3.0/redux-thunk.js"></script>
  </head>

  <body>
    <div id="root"></div>
    <script type="text/babel">
      // bring in stuff from cdn's
      const { HashRouter, Route, Link, NavLink } = ReactRouterDOM;
      const { createStore, applyMiddleware } = Redux;
      const { Provider, connect } = ReactRedux;

      //////////////////////////////////////////////////////////////////////////

      // define some constants here
      const GET_SCHOOLS = 'GET_SCHOOLS';
      const GET_STUDENTS = 'GET_STUDENTS';

      // action creators
      const _getSchools = schools => {
        return {
          type: GET_SCHOOLS,
          schools
        };
      };

      const _getStudents = students => {
        return {
          type: GET_STUDENTS,
          students
        };
      };

      // create redux initial state
      const initialState = {
        schools: [],
        students: [],
        school: {},
        student: {}
      };

      // thunks
      const getSchools = () => {
        return async dispatch => {
          const response = await axios.get(`/api/schools/`);
          dispatch(_getSchools(response.data));
        };
      };

      const getStudents = () => {
        return async dispatch => {
          const response = await axios.get(`/api/students/`);
          dispatch(_getStudents(response.data));
        };
      };

      // main reducer, think about using combine reducer later
      const reducer = (state = initialState, action) => {
        switch (action.type) {
          case GET_SCHOOLS:
            return {
              ...state,
              schools: action.schools
            };
          case GET_STUDENTS:
            return {
              ...state,
              students: action.students
            };
          default:
            return state;
        }
      };

      // create redux store
      const store = createStore(reducer, applyMiddleware(ReduxThunk.default));

      //////////////////////////////////////////////////////////////////////////
      // time for react
      const _NavBar = ({ schools, students }) => {
        const { pathname } = location;
        const activeStyle = {
          fontWeight: 'bold',
          color: 'white',
          textDecoration: 'none'
        };
        return (
          <div id="navbar">
            <span style={{ fontSize: '35px', marginRight: '4em' }}>
              <NavLink to="/" activeStyle={activeStyle}>
                ACME Schools
              </NavLink>
            </span>
            <NavLink to="/schools" activeStyle={activeStyle}>
              Schools ({schools.length})
            </NavLink>
            <NavLink to="/students" activeStyle={activeStyle}>
              Students ({students.length})
            </NavLink>
          </div>
        );
      };
      const NavBar = connect(state => {
        return {
          schools: state.schools,
          students: state.students
        };
      })(_NavBar);

      class _Routes extends React.Component {
        componentDidMount() {
          this.props.loadSchools();
          this.props.loadStudents();
        }
        render() {
          return (
            <HashRouter>
              <Route component={NavBar} />
            </HashRouter>
          );
        }
      }
      const Routes = connect(
        null,
        dispatch => {
          return {
            loadSchools: () => dispatch(getSchools()),
            loadStudents: () => dispatch(getStudents())
          };
        }
      )(_Routes);

      const App = () => {
        return (
          <Provider store={store}>
            <Routes />
          </Provider>
        );
      };

      const root = document.querySelector('#root');
      ReactDOM.render(<App />, root);
    </script>
  </body>
</html>
